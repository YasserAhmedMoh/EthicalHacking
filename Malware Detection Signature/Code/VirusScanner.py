#Virus Scanner Program
import sys, re, glob, hashlib, os, subprocess

#SCAN SIGNATURES

SignaturesSaved = []
SignatureDetail = []

# GET SIGNATURES FROM THE DATABASE
def GetSignatures():
    
    with open('SignatureDatabase.txt') as myDatabase:
        text = myDatabase.readlines()

        for line in text:
            signatures = line[:10] + '\n'
            encoded=signatures.encode()
            hashValue = hashlib.sha256(encoded)
            SignaturesSaved.append(hashValue.hexdigest())
            SignatureDetail.append(line)
            

def ScanSignatures():

    print("LOOKING FOR ANY MALICOUS SIGNATURES... \n")
    GetSignatures()
    # GET EVERY PROGRAM IN THE DIRECTORYs
    Allprograms = glob.glob("LocalDisk/*.py")
    for program in Allprograms:
        fileInfected = False
        file = open(program , "r")
        lines = file.readlines()
        file.close()

        for line in lines:
            for i in range(len(SignaturesSaved)): 
                encoded=line.encode()
                fileHash = hashlib.sha256(encoded)
                
                if (fileHash.hexdigest() == SignaturesSaved[i]):
                    #FOUND A VIRUS
                    programLocation = os. getcwd() 
                    print("VIRUS DETECTED @ " + programLocation + program )
                    print(fileHash)
                    print("VIRUS DETAILS ::: " + SignatureDetail[i])
                    fileInfected = True
                    rogramLocation = os.system('rm program ')


ScanSignatures() 
