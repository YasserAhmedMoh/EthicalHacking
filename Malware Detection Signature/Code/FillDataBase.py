import hashlib
import os

####################################FILL DATABASE WITH HASH OF DISCOVERED VIRUSES################################
def FillDatabase(pathGiven):  
    # NO DUPLICATES 
    # (TO PREVENT THE FN. OF GETTING THE HASH OF THE SAME FILE AND STORING IT AGAIN)
    hashes = set()
            
    # SCAN DIRECTORY 
    entries = os.scandir(pathGiven)
    # GET THE HASH OF EVERY DISCOVERED VIRUS FROM THE GIVEN DIRECTORY
    # AND STORE IT IN THE DATABASE
    for entry in entries:
        
        entryPath = pathGiven + entry.name
        file = open( entryPath, "rb") #READ BYTE
        fileData = file.read()
        # NO NEED FOR ENCODING AS FILE IS BINARY
        hashValue = hashlib.sha512(fileData)
        # CONVERT TO HEXADECIMAL
        hashDigest = hashValue.hexdigest() 
        hashes.add(hashDigest)
        
        #OPEN FILE IN APPEND MODE
        myDatabase = open('Hashes.txt','a')     
        myDatabase.write(hashDigest + " # " + entry.name + " Risk Level 1 \n" )
        myDatabase.close()
    
    print( "OPERATION SUCCEEDED ")

FillDatabase("DBofViruses/")
